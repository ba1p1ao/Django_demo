  åç«¯å¾…å®ç°çš„APIæ¥å£æ¸…å•

  1. é”™é¢˜æœ¬æ¨¡å—ï¼ˆ4ä¸ªæ¥å£ï¼‰
   - GET /mistake/list/ - è·å–é”™é¢˜åˆ—è¡¨ ok
   - GET /mistake/statistics/ - è·å–é”™é¢˜ç»Ÿè®¡ ok è·å–é”™é¢˜åˆ—è¡¨å’Œè·å–é”™é¢˜ç»Ÿè®¡ï¼Œåˆå¹¶ä¸ºä¸€ä¸ªæ¥å£å®ç°
   - PUT /mistake/{mistake_id}/mastered/ - æ ‡è®°é”™é¢˜ä¸ºå·²æŒæ¡ ok
   - POST /mistake/export/ - å¯¼å‡ºé”™é¢˜æœ¬  ok

  2. é˜²ä½œå¼Šæ¨¡å—ï¼ˆ2ä¸ªæ¥å£ï¼‰
   - POST /exam/behavior/log/ - è®°å½•è€ƒè¯•è¡Œä¸º 
   - GET /exam/{exam_record_id}/behavior/logs/ - è·å–è€ƒè¯•è¡Œä¸ºè®°å½•

  3. æ•°æ®å¯è§†åŒ–æ¨¡å—ï¼ˆ3ä¸ªæ¥å£ï¼‰
   - GET /exam/{exam_id}/chart/score-distribution/ - è·å–è€ƒè¯•æˆç»©åˆ†å¸ƒå›¾æ•°æ® ok
   - GET /exam/{exam_id}/chart/question-correctness/ - è·å–é¢˜ç›®æ­£ç¡®ç‡å›¾æ•°æ® ok
   - GET /student/chart/score-comparison/ - è·å–å­¦ç”Ÿæˆç»©å¯¹æ¯”å›¾æ•°æ® ok

  4. è€ƒè¯•åˆ†ææŠ¥å‘Šæ¨¡å—ï¼ˆ4ä¸ªæ¥å£ï¼‰
   - POST /exam/{exam_id}/report/generate/ - ç”Ÿæˆè€ƒè¯•åˆ†ææŠ¥å‘Š ok
   - GET /exam/{exam_id}/report/export/ - å¯¼å‡ºè€ƒè¯•åˆ†ææŠ¥å‘Šï¼ˆPDFï¼‰ ok
   - POST /exam/{exam_id}/report/email/ - å‘é€æˆç»©å•é‚®ä»¶ ä¸éœ€è¦å®Œæˆï¼ŒåºŸå¼ƒæ–¹æ¡ˆ
   - POST /exam/auto-submit/ - è‡ªåŠ¨æäº¤è¯•å·  ok å‰ç«¯å®ç°



"GET /api/class/1/exam-ranking/?exam_id=1&page=1&size=100 HTTP/1.1" 404 4665

ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜ï¼ˆç«‹å³ä¿®å¤ï¼‰

  1. è°ƒè¯•ä»£ç æœªæ¸…ç†
  å¤§é‡ print() è°ƒè¯•è¯­å¥æ•£è½åœ¨å„ä¸ªæ–‡ä»¶ä¸­ï¼Œåº”è¯¥ç§»é™¤ï¼š
   - exam_system/apps/question/views.py:109, 162, 181
   - exam_system/apps/exam/views.py:187, 189
   - exam_system/apps/classes/views.py:31, 56, 437
   - exam_system/apps/adminer/views.py:140
   - exam_system/apps/student/views.py:59, 134, 149, 163
   - exam_system/utils/ReportPDF.py:39, 42, 52, 54, 58

  2. æ‹¼å†™é”™è¯¯
   - exam_system/apps/question/views.py:229 - filed åº”ä¸º failed
   - exam_system/apps/classes/views.py:456 - highest_averag åº”ä¸º highest_average
   - exam_system/utils/ResponseMessage.py:28 - response_dta åº”ä¸º response_data

  3. æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç 
   - exam_system/exam_system/settings.py:28 - SECRET_KEY åº”ä½¿ç”¨ç¯å¢ƒå˜é‡
   - exam_system/exam_system/settings.py:85 - æ•°æ®åº“å¯†ç ç¡¬ç¼–ç ä¸º "123"

  4. ç”Ÿäº§ç¯å¢ƒé…ç½®é—®é¢˜
   - DEBUG = True - ç”Ÿäº§ç¯å¢ƒåº”è®¾ä¸º False
   - ALLOWED_HOSTS = [] - åº”é…ç½®å…·ä½“åŸŸå
   - CORS_ORIGIN_ALLOW_ALL = True - åº”é™åˆ¶å…è®¸çš„åŸŸå

  ---

  ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜ï¼ˆä¸­æœŸæ”¹è¿›ï¼‰

  5. æ•°æ®åº“æ€§èƒ½é—®é¢˜
   - N+1 æŸ¥è¯¢ï¼šexam_system/apps/exam/serializers.py:185-196 åœ¨å¾ªç¯ä¸­æŸ¥è¯¢ AnswerRecord
   - ç´¢å¼•è¢«æ³¨é‡Šï¼šå¤šä¸ª Model çš„ indexes è¢«æ³¨é‡Šæ‰ï¼Œå½±å“æŸ¥è¯¢æ€§èƒ½

  6. å®‰å…¨æ€§é—®é¢˜
   - JWT Token æœ‰æ•ˆæœŸè¿‡é•¿ï¼š24å°æ—¶ï¼Œå»ºè®®ç¼©çŸ­ä¸º1-2å°æ—¶
   - å¯†ç éªŒè¯ä¸ä¸¥æ ¼ï¼šæ³¨å†Œæ¥å£ç¼ºå°‘å¯¹ admin è§’è‰²çš„éªŒè¯
   - æƒé™éªŒè¯ä¸ç»Ÿä¸€ï¼šéƒ¨åˆ†æ¥å£æœªä½¿ç”¨ @check_permission è£…é¥°å™¨

  7. ç¼“å­˜æœªä½¿ç”¨
  è™½ç„¶é…ç½®äº† Redisï¼Œä½†æ•´ä¸ªä»£ç åº“ä¸­å‡ ä¹æœªä½¿ç”¨ç¼“å­˜åŠŸèƒ½

  8. è¾“å…¥éªŒè¯ç¼ºå¤±
   - exam_system/apps/question/views.py:88-95 - page_size æ²¡æœ‰éªŒè¯æœ€å¤§å€¼ï¼Œå¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜

  ---

  ğŸŸ¢ ä½ä¼˜å…ˆçº§é—®é¢˜ï¼ˆé•¿æœŸæ”¹è¿›ï¼‰

  9. ä»£ç ç»„ç»‡é—®é¢˜
   - æ‰€æœ‰åº”ç”¨éƒ½æ”¾åœ¨ apps/ ç›®å½•ä¸‹ï¼Œä¸ç¬¦åˆ Django æœ€ä½³å®è·µ
   - æ¨¡å—é—´è€¦åˆåº¦é«˜ï¼ˆå¦‚ adminer ç›´æ¥ä¾èµ– classesï¼‰

  10. æ³¨é‡Šå’Œæ–‡æ¡£
   - exam_system/apps/mistake/views.py - å¤§é‡æ³¨é‡Šçš„æ—§ä»£ç æœªåˆ é™¤
   - exam_system/utils/demo.py - æ•´ä¸ªæ–‡ä»¶éƒ½æ˜¯æ³¨é‡Šæ‰çš„ä»£ç 

  11. å‰ç«¯å®‰å…¨
   - ä½¿ç”¨ localStorage å­˜å‚¨ token å­˜åœ¨ XSS é£é™©ï¼Œå»ºè®®ä½¿ç”¨ httpOnly cookie

  12. åŠŸèƒ½ç¼ºå¤±
   - é˜²ä½œå¼Šæ¨¡å—ï¼ˆè€ƒè¯•è¡Œä¸ºè®°å½•ï¼‰æœªå®ç°
   - æ•°æ®å¯è§†åŒ–æ¨¡å—ï¼ˆè€ƒè¯•æˆç»©åˆ†å¸ƒå›¾ã€é¢˜ç›®æ­£ç¡®ç‡å›¾ï¼‰æœªå®ç°
   - é”™é¢˜æœ¬æ ‡è®°å·²æŒæ¡åŠŸèƒ½æœªå®ç°
   - ç”¨æˆ·åˆ é™¤åŠŸèƒ½ä¸å®Œæ•´ï¼ˆç¼ºå°‘å¯¹è€ƒè¯•è®°å½•çš„æ£€æŸ¥ï¼‰

  ---
  
  
  
  
  
  
  æ ¹æ®åˆ†ææŠ¥å‘Šï¼Œæˆ‘ä¸ºä½ æ•´ç†å‡ºé¡¹ç›®ä¸­å¯ä»¥ä½¿ç”¨ç¼“å­˜çš„åœ°æ–¹ï¼š

  ---

  ğŸ“‹ ç¼“å­˜ä½¿ç”¨åœºæ™¯åˆ†æ

  1. é«˜é¢‘æŸ¥è¯¢çš„æ•°æ®


  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ä½ç½®                 â”‚ å‡½æ•°                        â”‚ ç¼“å­˜é”®å»ºè®®                                  â”‚ è¿‡æœŸæ—¶é—´ â”‚ å¤±æ•ˆç­–ç•¥           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ question/views.py:64 â”‚ QuestionListView.get()      â”‚ questions:list:{page}:{size}:{filters_hash} â”‚ 30åˆ†é’Ÿ   â”‚ é¢˜ç›®å¢åˆ æ”¹æ—¶åˆ é™¤   â”‚ok
  â”‚ question/views.py:92 â”‚ QuestionInfoView.retrieve() â”‚ question:info:{id}                          â”‚ 1å°æ—¶    â”‚ é¢˜ç›®æ›´æ–°æ—¶åˆ é™¤     â”‚ok
  â”‚ exam/views.py:56     â”‚ ExamListView.get()          â”‚ exams:list:{page}:{size}:{filters_hash}     â”‚ 15åˆ†é’Ÿ   â”‚ è¯•å·å¢åˆ æ”¹æ—¶åˆ é™¤   â”‚ok
  â”‚ exam/views.py:263    â”‚ ExamAvailableView.list()    â”‚ exams:available:{user_id}                   â”‚ 5åˆ†é’Ÿ    â”‚ è¯•å·çŠ¶æ€å˜æ›´æ—¶åˆ é™¤ â”‚
  â”‚ exam/views.py:327    â”‚ ExamQuestionsView.get()     â”‚ exam:questions:{exam_id}                    â”‚ 1å°æ—¶    â”‚ è¯•å·é¢˜ç›®å˜æ›´æ—¶åˆ é™¤ â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---

  2. é™æ€é…ç½®æ•°æ®


  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ä½ç½®                 â”‚ å‡½æ•°                     â”‚ ç¼“å­˜é”®å»ºè®®                         â”‚ è¿‡æœŸæ—¶é—´ â”‚ å¤±æ•ˆç­–ç•¥         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ classes/views.py:26  â”‚ ClassOptionView.get()    â”‚ classes:options                    â”‚ 1å°æ—¶    â”‚ ç­çº§å¢åˆ æ”¹æ—¶åˆ é™¤ â”‚
  â”‚ classes/views.py:40  â”‚ ClassListView.get()      â”‚ classes:list:{page}:{filters_hash} â”‚ 30åˆ†é’Ÿ   â”‚ ç­çº§å¢åˆ æ”¹æ—¶åˆ é™¤ â”‚
  â”‚ adminer/views.py:106 â”‚ UserStatisticsView.get() â”‚ users:statistics                   â”‚ 5åˆ†é’Ÿ    â”‚ ç”¨æˆ·å¢åˆ æ”¹æ—¶åˆ é™¤ â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---

  3. è®¡ç®—å¯†é›†å‹æ“ä½œï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰


  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ä½ç½®               â”‚ å‡½æ•°                          â”‚ ç¼“å­˜é”®å»ºè®®                         â”‚ è¿‡æœŸ... â”‚ å¤±æ•ˆç­–ç•¥         â”‚ è¯´æ˜        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ `classes/views.... â”‚ ClassStatisticsView.get()     â”‚ class:statistics:{class_id}        â”‚ 15åˆ†é’Ÿ  â”‚ æ–°å¢è€ƒè¯•è®°å½•...  â”‚ å¤æ‚èšåˆ... â”‚
  â”‚ `classes/views.... â”‚ ClassExamRankingView.get()    â”‚ `class:exam_ranking:{class_id}:{e... â”‚ 10åˆ†é’Ÿ  â”‚ è€ƒè¯•è®°å½•æ›´æ–°...  â”‚ æ’åè®¡ç®—    â”‚
  â”‚ `classes/views.... â”‚ ClassScoreTrendView.get()     â”‚ class:score_trend:{class_id}:{days}  â”‚ 10åˆ†é’Ÿ  â”‚ è€ƒè¯•è®°å½•æ›´æ–°...  â”‚ è¶‹åŠ¿åˆ†æ    â”‚
  â”‚ `student/views.... â”‚ ScoreTrendView.get()          â”‚ student:score_trend:{user_id}:{days} â”‚ 10åˆ†é’Ÿ  â”‚ è€ƒè¯•è®°å½•æ›´æ–°...  â”‚ æˆç»©è¶‹åŠ¿    â”‚
  â”‚ `student/views.... â”‚ `StudentScoreComparisonVie... â”‚ student:score_comparison:{user_id}   â”‚ 10åˆ†é’Ÿ  â”‚ è€ƒè¯•è®°å½•æ›´æ–°...  â”‚ ç­çº§å¯¹æ¯”    â”‚
  â”‚ exam/views.py:828  â”‚ `ExamRecordStatisticsView.... â”‚ exam:statistics:{exam_id}          â”‚ 15åˆ†é’Ÿ  â”‚ è€ƒè¯•è®°å½•æ›´æ–°...  â”‚ è€ƒè¯•ç»Ÿè®¡    â”‚
  â”‚ exam/views.py:1005 â”‚ ExamRankingView.get()         â”‚ exam:ranking:{exam_id}:{class_id}    â”‚ 10åˆ†é’Ÿ  â”‚ è€ƒè¯•è®°å½•æ›´æ–°...  â”‚ æ’åè®¡ç®—    â”‚
  â”‚ exam/views.py:1172 â”‚ ExamReportGenerate.post()     â”‚ exam:report:{exam_id}              â”‚ 1å°æ—¶   â”‚ è€ƒè¯•è®°å½•æ›´æ–°...  â”‚ PDFç”Ÿæˆ     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---

  ğŸ”§ å®ç°æ–¹æ³•

  æ–¹æ³•1: ä½¿ç”¨ Django ç¼“å­˜è£…é¥°å™¨ï¼ˆæ¨èç”¨äºç®€å•æŸ¥è¯¢ï¼‰

    1 from django.core.cache import cache
    2 
    3 def QuestionListView(APIView):
    4     def get(self, request):
    5         # ç”Ÿæˆç¼“å­˜é”®
    6         filters_hash = hash(str(sorted(request.GET.items())))
    7         cache_key = f'questions:list:{pagination.page}:{pagination.size}:{filters_hash}'
    8 
    9         # å°è¯•ä»ç¼“å­˜è·å–
   10         cached_data = cache.get(cache_key)
   11         if cached_data:
   12             return MyResponse.success(data=cached_data)
   13 
   14         # æ‰§è¡ŒæŸ¥è¯¢
   15         # ... æŸ¥è¯¢é€»è¾‘ ...
   16 
   17         # å­˜å…¥ç¼“å­˜
   18         cache.set(cache_key, response_data, 30 * 60)  # 30åˆ†é’Ÿ
   19         return MyResponse.success(data=response_data)

  ---

  æ–¹æ³•2: ä½¿ç”¨ Django ç¼“å­˜è£…é¥°å™¨ï¼ˆæ¨èç”¨äºå‡½æ•°ï¼‰

    1 from django.core.cache import cache
    2 from functools import wraps
    3 
    4 def cache_result(timeout=60*30, key_prefix=''):
    5     def decorator(func):
    6         @wraps(func)
    7         def wrapper(*args, **kwargs):
    8             # ç”Ÿæˆç¼“å­˜é”®
    9             cache_key = f'{key_prefix}:{str(args)}:{str(kwargs)}'
   10 
   11             # å°è¯•ä»ç¼“å­˜è·å–
   12             cached_data = cache.get(cache_key)
   13             if cached_data is not None:
   14                 return cached_data
   15 
   16             # æ‰§è¡Œå‡½æ•°
   17             result = func(*args, **kwargs)
   18 
   19             # å­˜å…¥ç¼“å­˜
   20             cache.set(cache_key, result, timeout)
   21             return result
   22         return wrapper
   23     return decorator
   24 
   25 # ä½¿ç”¨ç¤ºä¾‹
   26 @cache_result(timeout=60*15, key_prefix='class:statistics')
   27 def get_class_statistics(class_id):
   28     # ... æŸ¥è¯¢é€»è¾‘ ...
   29     return result

  ---

  æ–¹æ³•3: æ‰‹åŠ¨ç¼“å­˜ç®¡ç†ï¼ˆæ¨èç”¨äºå¤æ‚åœºæ™¯ï¼‰

    1 from django.core.cache import cache
    2 
    3 class ClassStatisticsView(APIView):
    4     def get(self, request, class_id):
    5         cache_key = f'class:statistics:{class_id}'
    6 
    7         # å°è¯•ä»ç¼“å­˜è·å–
    8         cached_data = cache.get(cache_key)
    9         if cached_data:
   10             return MyResponse.success(data=cached_data)
   11 
   12         # æ‰§è¡ŒæŸ¥è¯¢
   13         # ... å¤æ‚çš„èšåˆæŸ¥è¯¢ ...
   14 
   15         # å­˜å…¥ç¼“å­˜
   16         cache.set(cache_key, response_data, 15 * 60)
   17         return MyResponse.success(data=response_data)

  ---

  æ–¹æ³•4: ç¼“å­˜å¤±æ•ˆï¼ˆåœ¨æ•°æ®æ›´æ–°æ—¶åˆ é™¤ç¼“å­˜ï¼‰

    1 # åœ¨é¢˜ç›®æ›´æ–°æ—¶åˆ é™¤ç›¸å…³ç¼“å­˜
    2 def QuestionInfoView.update(self, request, *args, **kwargs):
    3     # ... æ›´æ–°é€»è¾‘ ...
    4 
    5     # åˆ é™¤é¢˜ç›®è¯¦æƒ…ç¼“å­˜
    6     cache.delete(f'question:info:{question.id}')
    7 
    8     # åˆ é™¤é¢˜ç›®åˆ—è¡¨ç¼“å­˜ï¼ˆä½¿ç”¨é€šé…ç¬¦ï¼‰
    9     cache.delete_many(cache.keys('questions:list:*'))
   10 
   11     # æˆ–è€…åˆ é™¤æ‰€æœ‰é¢˜ç›®ç›¸å…³ç¼“å­˜
   12     cache.delete_pattern('questions:*')

  ---

  ğŸ“Š å®ç°ä¼˜å…ˆçº§å»ºè®®

  ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼ˆç«‹å³å®ç°ï¼‰
   1. è€ƒè¯•æŠ¥å‘Šç”Ÿæˆ (exam:report:{exam_id}) - PDFç”Ÿæˆæœ€è€—æ—¶
   2. ç­çº§ç»Ÿè®¡ (class:statistics:{class_id}) - èšåˆæŸ¥è¯¢å¤æ‚
   3. è€ƒè¯•æ’å (exam:ranking:{exam_id}:{class_id}) - æ’åºè®¡ç®—é‡

  ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆçŸ­æœŸå®ç°ï¼‰
   4. ç­çº§è€ƒè¯•æ’å
   5. ç­çº§æˆç»©è¶‹åŠ¿
   6. å­¦ç”Ÿæˆç»©è¶‹åŠ¿
   7. ç³»ç»Ÿç»Ÿè®¡

  ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼ˆé•¿æœŸä¼˜åŒ–ï¼‰
   8. é¢˜ç›®åˆ—è¡¨
   9. è¯•å·åˆ—è¡¨
   10. ç­çº§é€‰é¡¹

  ---

  ğŸ’¡ æ³¨æ„äº‹é¡¹

âœ¦  1. ç¼“å­˜é”®å‘½åè§„èŒƒï¼šä½¿ç”¨å†’å·åˆ†éš”å±‚çº§ï¼Œå¦‚ class:statistics:{class_id}
   2. è¿‡æœŸæ—¶é—´ï¼šæ ¹æ®æ•°æ®æ›´æ–°é¢‘ç‡è®¾ç½®ï¼Œç»Ÿè®¡æ•°æ®å»ºè®® 5-15 åˆ†é’Ÿ
   3. ç¼“å­˜å¤±æ•ˆï¼šåœ¨æ•°æ®æ›´æ–°æ—¶ä¸»åŠ¨åˆ é™¤ç›¸å…³ç¼“å­˜
   4. ç¼“å­˜é¢„çƒ­ï¼šç³»ç»Ÿå¯åŠ¨æ—¶åŠ è½½é«˜é¢‘æ•°æ®åˆ°ç¼“å­˜
   5. ç¼“å­˜ç›‘æ§ï¼šè®°å½•ç¼“å­˜å‘½ä¸­ç‡ï¼Œè¯„ä¼°æ•ˆæœ

